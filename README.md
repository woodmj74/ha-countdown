# ha-countdown

My variation of https://github.com/mf-social/ps-date-countdown (*which by the way is awesome!*).

This was done by using mf-socials script and hacking aorund (with extensive use of Google), I've never written a real line of code before so appreciate any suggestions!!

For my needs, I wanted a sensor as well which reminded me 4 and 2 weeks before a birthday. To do this without having to reference each individual birthday sensor and build an automation for it, created a group for each sensor generated by ps-date-countdown. Against this created a two and four week sensor, expanded the group in the sensor and if matches were made for the time window added the birthday in an attribue which was then included in a message within an automation.

Why did I change this? Each time I wanted to add a new birthday I had to add a new call into the automation which ran the script, then for my warning sensors I had to update the associated group with the new auto generated sensor. Given I was editing YAML for the group, figured what if I just updated one place and therefore that could be the script. Given the dates don't change and only myself updates this it seemed a sensible thing to do and would always remember the single update place.

(ideally, I'd love to be able to wildcard in a group, like ```include: sensor.birthday_*```)

Then had this running behind the sensor.
```
- id: '1602361830298'
  alias: Reminder - Birthdays Within Four Weeks
  description: ''
  trigger:
  - platform: state
    entity_id: sensor.birthdays_four_weeks
  condition:
  - condition: not
    conditions:
    - condition: state
      entity_id: sensor.birthdays_four_weeks
      state: '0'
  - condition: template
    value_template: '{{ trigger.from_state.state != trigger.to_state.state }}'
  action:
  - service: notify.mike
    data:
      message: '{%- set ns = namespace(message = ''The following birthday(s) are within
        30 days:\n'') -%}  {%- set ns.message = ns.message +  state_attr(''sensor.birthdays_four_weeks'',''upcoming'').split(''|'')
        | join('' days \n'')  -%} {{ ns.message }}'
      title: '** Birthday Reminder **'
```      
      
